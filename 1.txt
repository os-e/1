%{
/*
 * Lex Program 1: Count Lines and Characters
 * This program counts the number of lines and characters in the input file
 */
#include <stdio.h>
int line_count = 0;
int char_count = 0;
%}

%%
\n      { line_count++; char_count++; }
.       { char_count++; }
%%

int yywrap() {
    return 1;
}

int main(int argc, char *argv[]) {
    printf("Enter text to count (Press Ctrl+Z then Enter to end):\n");
    yylex();
    printf("\n=================================\n");
    printf("Total Lines: %d\n", line_count);
    printf("Total Characters: %d\n", char_count);
    printf("=================================\n");
    return 0;
}

%{
/*
 * Lex Program 2: Count Vowels and Consonants
 * This program counts the number of vowels and consonants in a given string
 */
#include <stdio.h>
int vowel_count = 0;
int consonant_count = 0;
%}

%%
[aeiouAEIOU]    { vowel_count++; }
[a-zA-Z]        { consonant_count++; }
.               { /* Ignore other characters */ }
\n              { /* Ignore newlines */ }
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter a string: ");
    yylex();
    printf("\n=================================\n");
    printf("Number of Vowels: %d\n", vowel_count);
    printf("Number of Consonants: %d\n", consonant_count);
    printf("=================================\n");
    return 0;
}

%{
/*
 * Lex Program 3: Caesar Cipher
 * Replaces every letter with the one three letters after in alphabetical order
 * Wrapping around at Z (e.g., a->d, b->e, ..., z->c)
 */
#include <stdio.h>

char caesar_encrypt(char c) {
    if (c >= 'a' && c <= 'z') {
        return ((c - 'a' + 3) % 26) + 'a';
    } else if (c >= 'A' && c <= 'Z') {
        return ((c - 'A' + 3) % 26) + 'A';
    }
    return c;
}
%}

%%
[a-zA-Z]    { printf("%c", caesar_encrypt(yytext[0])); }
.           { printf("%c", yytext[0]); }
\n          { printf("\n"); }
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter text to encrypt with Caesar Cipher (shift=3):\n");
    yylex();
    return 0;
}

%{
    /*
     * Lex Program 4: Find Longest Word
     * Finds the longest word (contiguous string of upper and Lower case letters)
     */

    #include <stdio.h>
    #include <string.h>

    char longest_word[1000] = "";
    int max_length = 0;
%}

%%
[a-zA-Z]+    {
                int len = strlen(yytext);
                if (len > max_length) {
                    max_length = len;
                    strcpy(longest_word, yytext);
                }
             }

.            { /* Ignore other characters */ }
\n           { /* Ignore newlines */ }
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter text (Press Ctrl+D or Ctrl+Z to end):\n");
    yylex();
    printf("\n=======================================\n");
    if (max_length > 0) {
        printf("Longest Word: %s\n", longest_word);
        printf("Length: %d\n", max_length);
    } else {
        printf("No words found.\n");
    }
    printf("---------------------------------------\n");
}

%{
/*
 * Lex Program 5: Lexical Analyzer
 * Distinguishes keywords, integers, floats, identifiers, operators, and comments
 */
#include <stdio.h>
%}

%%
"if"|"else"|"while"|"for"|"int"|"float"|"return"|"void"|"main"   {
    printf("KEYWORD: %s\n", yytext);
}

[0-9]+\.[0-9]+  {
    printf("FLOAT: %s\n", yytext);
}

[0-9]+  {
    printf("INTEGER: %s\n", yytext);
}

[a-zA-Z_][a-zA-Z0-9_]*  {
    printf("IDENTIFIER: %s\n", yytext);
}

"+"|"-"|"*"|"/"|"="|"=="|"!="|"<"|">"|"<="|">="  {
    printf("OPERATOR: %s\n", yytext);
}

"//".* {
    printf("COMMENT: %s\n", yytext);
}

"/*"([^*]|\*+[^*/])*\*+"/" {
    printf("MULTI-LINE COMMENT: %s\n", yytext);
}

"("|")"|"{"|"}"|"["|"]"|";"|","  {
    printf("SPECIAL SYMBOL: %s\n", yytext);
}

[ \t\n]+    { /* Ignore whitespace */ }

.   {
    printf("UNKNOWN: %s\n", yytext);
}
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter code (Press Ctrl+D or Ctrl+Z to end):\n");
    yylex();
    return 0;
}

%{
/*
 * Lex Program 6: C File Analyzer
 * Counts words, characters, blank spaces, and lines in a C file
 */
#include <stdio.h>
int word_count = 0;
int char_count = 0;
int space_count = 0;
int line_count = 0;
%}

%%
[ \t]+      { space_count += yyleng; char_count += yyleng; }
\n          { line_count++; char_count++; }
[a-zA-Z_][a-zA-Z0-9_]*  { word_count++; char_count += yyleng; }
.           { char_count++; }
%%

int yywrap() {
    return 1;
}

int main(int argc, char *argv[]) {
    printf("Enter C code (Press Ctrl+D or Ctrl+Z to end):\n");
    yylex();
    printf("\n=================================\n");
    printf("Total Words: %d\n", word_count);
    printf("Total Characters: %d\n", char_count);
    printf("Total Blank Spaces: %d\n", space_count);
    printf("Total Lines: %d\n", line_count);
    printf("=================================\n");
    return 0;
}

%{
/*
 * Lex Program 7: String Pattern Printer
 * Takes a string "abcd" and prints: abcd, abc, ab, a
 */
#include <stdio.h>
#include <string.h>

void print_pattern(char *str) {
    int len = strlen(str);
    for (int i = len; i > 0; i--) {
        for (int j = 0; j < i; j++) {
            printf("%c", str[j]);
        }
        printf("\n");
    }
}
%}

%%
[a-zA-Z]+   {
                printf("Input: %s\n", yytext);
                printf("Output:\n");
                print_pattern(yytext);
            }
.|\n        { /* Ignore other characters */ }
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter a string (e.g., abcd): ");
    yylex();
    return 0;
}

%{
/*
 * Lex Program 8: Arithmetic Expression Validator
 * Recognizes and validates arithmetic expressions
 */
#include <stdio.h>
int valid = 1;
%}

%%
[0-9]+          { printf("NUMBER: %s\n", yytext); }
"+"|"-"|"*"|"/" { printf("OPERATOR: %s\n", yytext); }
"("             { printf("LEFT_PAREN\n"); }
")"             { printf("RIGHT_PAREN\n"); }
[ \t\n]+        { /* Ignore whitespace */ }
.               { 
                    printf("INVALID CHARACTER: %s\n", yytext); 
                    valid = 0;
                }
%%

int yywrap() {
    return 1;
}

int main() {
    printf("Enter an arithmetic expression: ");
    yylex();
    if (valid) {
        printf("\n=================================\n");
        printf("Expression is VALID\n");
        printf("=================================\n");
    } else {
        printf("\n=================================\n");
        printf("Expression is INVALID\n");
        printf("=================================\n");
    }
    return 0;
}

%{
/*
 * Lex file for Expression Validator (Program 9)
 * Companion to 09_expression_validator.y
 */
#include "09_expression_validator.tab.h"
#include <stdio.h>
extern int yylval;
%}

%%
[a-z][0-9]      { yylval = yytext[0]; return VARIABLE; }
[0-9]+          { yylval = atoi(yytext); return NUMBER; }
"+"             { return PLUS; }
"-"             { return MINUS; }
"*"             { return MULTIPLY; }
"/"             { return DIVIDE; }
"("             { return LPAREN; }
")"             { return RPAREN; }
\n              { return NEWLINE; }
[ \t]+          { /* Ignore whitespace */ }
.               { printf("Invalid character: %s\n", yytext); }
%%

int yywrap() {
    return 1;
}
%{
/*
 * YACC Program 9: Expression Validator
 * Validates arithmetic expressions with operators +, -, *, /
 * Recognizes valid variables (lowercase letter followed by digit)
 */
#include <stdio.h>
#include <stdlib.h>

void yyerror(const char *s);
int yylex(void);
%}

%token NUMBER VARIABLE
%token PLUS MINUS MULTIPLY DIVIDE
%token LPAREN RPAREN NEWLINE

%left PLUS MINUS
%left MULTIPLY DIVIDE

%%
program:
    | program line
    ;

line:
    NEWLINE
    | expr NEWLINE  { printf("Valid expression!\n\n"); }
    ;

expr:
    NUMBER
    | VARIABLE      { printf("Valid variable detected\n"); }
    | expr PLUS expr
    | expr MINUS expr
    | expr MULTIPLY expr
    | expr DIVIDE expr
    | LPAREN expr RPAREN
    ;
%%

void yyerror(const char *s) {
    fprintf(stderr, "Error: %s\n", s);
}

int main() {
    printf("Expression Validator\n");
    printf("====================\n");
    printf("Enter expressions (variables: lowercase letter + digit, e.g., a1, b2)\n");
    printf("Press Ctrl+D or Ctrl+Z to exit\n\n");
    yyparse();
    return 0;
}
%{
/*
 * Lex file for Calculator (Program 10)
 * Companion to 10_calculator.y
 */
#include "10_calculator.tab.h"
#include <stdio.h>
extern int yylval;
%}

%%
[0-9]+          { yylval = atoi(yytext); return NUMBER; }
"+"             { return PLUS; }
"-"             { return MINUS; }
"*"             { return MULTIPLY; }
"/"             { return DIVIDE; }
"("             { return LPAREN; }
")"             { return RPAREN; }
\n              { return NEWLINE; }
[ \t]+          { /* Ignore whitespace */ }
.               { printf("Invalid character: %s\n", yytext); }
%%

int yywrap() {
    return 1;
}
%{
/*
 * YACC Program 10: Simple Calculator
 * Evaluates arithmetic expressions with +, -, *, /
 * Handles operator precedence and parentheses
 */
#include <stdio.h>
#include <stdlib.h>

void yyerror(const char *s);
int yylex(void);
%}

%token NUMBER
%token PLUS MINUS MULTIPLY DIVIDE
%token LPAREN RPAREN NEWLINE

%left PLUS MINUS
%left MULTIPLY DIVIDE

%%
program:
    | program line
    ;

line:
    NEWLINE
    | expr NEWLINE  { printf("Result: %d\n\n", $1); }
    ;

expr:
    NUMBER                      { $$ = $1; }
    | expr PLUS expr            { $$ = $1 + $3; }
    | expr MINUS expr           { $$ = $1 - $3; }
    | expr MULTIPLY expr        { $$ = $1 * $3; }
    | expr DIVIDE expr          { 
                                    if ($3 == 0) {
                                        yyerror("Division by zero");
                                        $$ = 0;
                                    } else {
                                        $$ = $1 / $3;
                                    }
                                }
    | LPAREN expr RPAREN        { $$ = $2; }
    ;
%%

void yyerror(const char *s) {
    fprintf(stderr, "Error: %s\n", s);
}

int main() {
    printf("Simple Calculator\n");
    printf("=================\n");
    printf("Enter arithmetic expressions (e.g., 5 + 3 * 2)\n");
    printf("Press Ctrl+D or Ctrl+Z to exit\n\n");
    yyparse();
    return 0;
}
%{
/* Program 11 Lex: Tokenizer for a^n b^n language */
#include "11_anbn.tab.h"
%}

%%
"a"             { return A; }
"b"             { return B; }
\n              { return EOL; }
[ \t]+          { /* ignore whitespace */ }
.               { return INVALID; }
%%

int yywrap() {
    return 1;
}
%{
/* Program 11: Recognize language a^n b^n (n >= 1) */
#include <stdio.h>
#include <stdlib.h>

void yyerror(const char *s);
int yylex();
%}

%token A B EOL INVALID

%%
input:
    /* empty */
    | input line
    ;

line:
    string EOL      { printf("Valid string of a^n b^n\n> "); }
    | EOL           { printf("> "); }
    | error EOL     { printf("Invalid string\n> "); yyerrok; }
    ;

string:
    A B             { /* a^1 b^1 */ }
    | A string B    { /* a^n b^n */ }
    ;

%%

void yyerror(const char *s) {
    /* Error handling */
}

int main() {
    printf("Language Recognizer: a^n b^n (n >= 1)\n");
    printf("Examples: ab, aabb, aaabbb\n");
    printf("Enter strings:\n> ");
    yyparse();
    return 0;
}
%{
/* Program 12 Lex: Tokenizer for a^n b language */
#include "12_anb.tab.h"
%}

%%
"a"             { return A; }
"b"             { return B; }
\n              { return EOL; }
[ \t]+          { /* ignore whitespace */ }
.               { return INVALID; }
%%

int yywrap() {
    return 1;
}
%{
/* Program 12: Recognize language a^n b (n >= 10) */
#include <stdio.h>
#include <stdlib.h>

void yyerror(const char *s);
int yylex();
int a_count = 0;
%}

%token A B EOL INVALID

%%
input:
    /* empty */
    | input line
    ;

line:
    string EOL      { 
                        if (a_count >= 10) {
                            printf("Valid: a^%d b (n >= 10)\n> ", a_count);
                        } else {
                            printf("Invalid: Only %d a's (need at least 10)\n> ", a_count);
                        }
                        a_count = 0;
                    }
    | EOL           { printf("> "); a_count = 0; }
    | error EOL     { printf("Invalid string\n> "); yyerrok; a_count = 0; }
    ;

string:
    a_sequence B    { /* a^n b where n is counted */ }
    ;

a_sequence:
    A               { a_count = 1; }
    | a_sequence A  { a_count++; }
    ;

%%

void yyerror(const char *s) {
    /* Error handling */
}

int main() {
    printf("Language Recognizer: a^n b (n >= 10)\n");
    printf("Example: aaaaaaaaaab (10 a's followed by b)\n");
    printf("Enter strings:\n> ");
    yyparse();
    return 0;
}

/*
================================================================================
COMPILATION AND EXECUTION COMMANDS
================================================================================

--- LEX PROGRAMS (1-8) ---

1. Line and Character Counter
   win_flex --outfile=lex.yy.c 01_line_char_counter.l
   gcc lex.yy.c -o line_counter.exe
   .\line_counter.exe

2. Vowel and Consonant Counter
   win_flex --outfile=lex.yy.c 02_vowel_consonant_counter.l
   gcc lex.yy.c -o vowel_counter.exe
   .\vowel_counter.exe

3. Caesar Cipher
   win_flex --outfile=lex.yy.c 03_caesar_cipher.l
   gcc lex.yy.c -o caesar.exe
   .\caesar.exe

4. Longest Word Finder
   win_flex --outfile=lex.yy.c 04_longest_word.l
   gcc lex.yy.c -o longest_word.exe
   .\longest_word.exe

5. Lexical Analyzer
   win_flex --outfile=lex.yy.c 05_lexical_analyzer.l
   gcc lex.yy.c -o lexical_analyzer.exe
   .\lexical_analyzer.exe

6. C File Analyzer
   win_flex --outfile=lex.yy.c 06_c_file_analyzer.l
   gcc lex.yy.c -o c_analyzer.exe
   .\c_analyzer.exe

7. String Pattern Printer
   win_flex --outfile=lex.yy.c 07_string_pattern.l
   gcc lex.yy.c -o pattern.exe
   .\pattern.exe

8. Arithmetic Validator
   win_flex --outfile=lex.yy.c 08_arithmetic_validator.l
   gcc lex.yy.c -o validator.exe
   .\validator.exe

--- YACC PROGRAMS (9-12) ---

9. Expression Validator
   win_bison -d 09_expression_validator.y
   win_flex --outfile=lex.yy.c 09_expression_validator.l
   gcc 09_expression_validator.tab.c lex.yy.c -o expr_validator.exe
   .\expr_validator.exe

10. Simple Calculator
    win_bison -d 10_calculator.y
    win_flex --outfile=lex.yy.c 10_calculator.l
    gcc 10_calculator.tab.c lex.yy.c -o calculator.exe
    .\calculator.exe

11. a^n b^n Recognizer
    win_bison -d 11_anbn.y
    win_flex --outfile=lex.yy.c 11_anbn.l
    gcc 11_anbn.tab.c lex.yy.c -o anbn.exe
    .\anbn.exe

12. a^n b Recognizer
    win_bison -d 12_anb.y
    win_flex --outfile=lex.yy.c 12_anb.l
    gcc 12_anb.tab.c lex.yy.c -o anb.exe
    .\anb.exe
*/
